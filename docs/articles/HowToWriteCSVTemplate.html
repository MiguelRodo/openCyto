<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How to write a csv gating template • openCyto</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="How to write a csv gating template">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">openCyto</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.21.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/HowToAutoGating.html">OpenCyto: How to use different auto gating functions</a>
    </li>
    <li>
      <a href="../articles/HowToWriteCSVTemplate.html">How to write a csv gating template</a>
    </li>
    <li>
      <a href="../articles/openCytoVignette.html">An Introduction to the openCyto package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>How to write a csv gating template</h1>
            
      
      
      <div class="hidden name"><code>HowToWriteCSVTemplate.Rmd</code></div>

    </div>

    
    
<div id="how-to-write-a-csv-gating-template" class="section level1">
<h1 class="hasAnchor">
<a href="#how-to-write-a-csv-gating-template" class="anchor"></a>How to write a csv gating template</h1>
<p>The <strong>openCyto</strong> package is uses a spreadsheet to compose the gating schemes. Basically each row corresponds to one population node in the gating hierarchy tree. However sometime it is verbose to describe every single population. So here we will explain how to make the template more succinct to easier to compose by using <code>pop</code> and <code>alias</code> pattern.</p>
<div id="pop--" class="section level2">
<h2 class="hasAnchor">
<a href="#pop--" class="anchor"></a><code>pop</code> = “+/-”</h2>
<p>For the 1d/2d gating function, we are normally interested in either positive(representing cell events within gate) or negative(or negated, representing cell events outside of the gate) by setting <code>pop</code> column in the form of <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code> or <code><a href="https://rdrr.io/r/base/Arithmetic.html">-</a></code>. But sometime we want to do the downstream gating for both. By specifying <code>pop</code> as <code>+/-</code>, the <code>template parser</code> will expand it into two rows internally.</p>
<p>For example, this row will be expanded automatically</p>
<table class="table">
<thead><tr class="header">
<th align="left">alias</th>
<th align="left">pop</th>
<th align="left">parent</th>
<th align="left">dims</th>
<th align="left">gating_method</th>
<th align="left">gating_args</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">*</td>
<td align="left">+/-</td>
<td align="left">cd3</td>
<td align="left">cd4</td>
<td align="left">mindensity</td>
<td align="left"></td>
</tr></tbody>
</table>
<p>to two rows:</p>
<table class="table">
<thead><tr class="header">
<th align="left">alias</th>
<th align="left">pop</th>
<th align="left">parent</th>
<th align="left">dims</th>
<th align="left">gating_method</th>
<th align="left">gating_args</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">cd4+</td>
<td align="left">+</td>
<td align="left">cd3</td>
<td align="left">cd4</td>
<td align="left">mindensity</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">cd4-</td>
<td align="left">-</td>
<td align="left">cd3</td>
<td align="left">cd4</td>
<td align="left">refGate</td>
<td align="left">cd3/cd4+</td>
</tr>
</tbody>
</table>
<p>Note that the second row uses <code>refGate</code> which simply copies the gate coordinates computed by <code>mindensity</code> in the first row, and assign the negative sign to the <code>pop</code> column indicating the population of interest is <code>cd4 negative</code>.</p>
</div>
<div id="pop" class="section level2">
<h2 class="hasAnchor">
<a href="#pop" class="anchor"></a><code>pop</code> = “++”</h2>
<p>Often time we need to apply 1d gating function on two dimensions separately and then use the two cutting points to construct <code>rectangleGate</code> to capture the cell events falling into one particular quadrant on the 2-d projections For example, <code>T helper</code> cells are usually represented as <code>CD4+CD8-</code>. Instead of writing three rows in the template, simply using <code>++</code> pattern in the <code>pop</code> column.<br>
e.g</p>
<table class="table">
<thead><tr class="header">
<th align="left">alias</th>
<th align="left">pop</th>
<th align="left">parent</th>
<th align="left">dims</th>
<th align="left">gating_method</th>
<th align="left">gating_args</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">T helper</td>
<td align="left">+-</td>
<td align="left">cd3</td>
<td align="left">cd4,cd8</td>
<td align="left">mindensity</td>
<td align="left"></td>
</tr></tbody>
</table>
<p>And the template parser will take care of the expansion automatically.</p>
<table class="table">
<thead><tr class="header">
<th align="left">alias</th>
<th align="left">pop</th>
<th align="left">parent</th>
<th align="left">dims</th>
<th align="left">gating_method</th>
<th align="left">gating_args</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">cd4+</td>
<td align="left">+</td>
<td align="left">cd3</td>
<td align="left">cd4</td>
<td align="left">mindensity</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">cd8+</td>
<td align="left">+</td>
<td align="left">cd3</td>
<td align="left">cd8</td>
<td align="left">mindensity</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">T helper</td>
<td align="left">+-</td>
<td align="left">cd3</td>
<td align="left">cd4,cd8</td>
<td align="left">refGate</td>
<td align="left">cd3/cd4+:cd3/cd8+</td>
</tr>
</tbody>
</table>
<p>As we see, first two rows do the actual gating by <code>mindensity</code> and the third row simply makes use the coordinates of that two 1d gates (<code>cd4+</code> and <code>cd8+</code>) and construct a <code>rectangleGate</code> (T helper) by using <code>refGate</code> as <code>gating_method</code>. And the <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code> and <code><a href="https://rdrr.io/r/base/Arithmetic.html">-</a></code> sign along with dimensions determines which quadrant to keep.</p>
</div>
<div id="pop---" class="section level2">
<h2 class="hasAnchor">
<a href="#pop---" class="anchor"></a><code>pop</code> = “+/-+/-”</h2>
<p>Apparently, we may want to get more than one quadrants by using the same mechanism. For example, we can set <code>pop</code> to <code>+/-+/-</code> to keep all of four quadrants.</p>
<table class="table">
<thead><tr class="header">
<th align="left">alias</th>
<th align="left">pop</th>
<th align="left">parent</th>
<th align="left">dims</th>
<th align="left">gating_method</th>
<th align="left">gating_args</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">*</td>
<td align="left">+/-+/-</td>
<td align="left">cd3</td>
<td align="left">cd4,cd8</td>
<td align="left">mindensity</td>
<td align="left"></td>
</tr></tbody>
</table>
<p>It will be expanded to six rows:</p>
<table class="table">
<thead><tr class="header">
<th align="left">alias</th>
<th align="left">pop</th>
<th align="left">parent</th>
<th align="left">dims</th>
<th align="left">gating_method</th>
<th align="left">gating_args</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">cd4+</td>
<td align="left">+</td>
<td align="left">cd3</td>
<td align="left">cd4</td>
<td align="left">mindensity</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">cd8+</td>
<td align="left">+</td>
<td align="left">cd3</td>
<td align="left">cd8</td>
<td align="left">mindensity</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">cd4+cd8+</td>
<td align="left">++</td>
<td align="left">cd3</td>
<td align="left">cd4,cd8</td>
<td align="left">refGate</td>
<td align="left">cd3/cd4+:cd3/cd8+</td>
</tr>
<tr class="even">
<td align="left">cd4-cd8+</td>
<td align="left">-+</td>
<td align="left">cd3</td>
<td align="left">cd4,cd8</td>
<td align="left">refGate</td>
<td align="left">cd3/cd4+:cd3/cd8+</td>
</tr>
<tr class="odd">
<td align="left">cd4+cd8-</td>
<td align="left">+-</td>
<td align="left">cd3</td>
<td align="left">cd4,cd8</td>
<td align="left">refGate</td>
<td align="left">cd3/cd4+:cd3/cd8+</td>
</tr>
<tr class="even">
<td align="left">cd4-cd8-</td>
<td align="left">–</td>
<td align="left">cd3</td>
<td align="left">cd4,cd8</td>
<td align="left">refGate</td>
<td align="left">cd3/cd4+:cd3/cd8+</td>
</tr>
</tbody>
</table>
<p>First two does the actual gating, and rest of four uses two 1d gates to construct four different <code>rectangleGate</code>s to represent four different quadrants.</p>
</div>
<div id="gating-method-that-generates-multiple-populations" class="section level2">
<h2 class="hasAnchor">
<a href="#gating-method-that-generates-multiple-populations" class="anchor"></a>Gating method that generates multiple populations</h2>
<div id="pop-and-alias-abc" class="section level3">
<h3 class="hasAnchor">
<a href="#pop-and-alias-abc" class="anchor"></a><code>pop</code> = "*" and <code>alias</code> = “A,B,C”</h3>
<p>So far, we’ve been talking about the gating functions that only returns one gate object( <code>S4 class</code> that extends <code><a href="https://rdrr.io/pkg/flowCore/man/filter-methods.html">flowCore::filter</a></code>). If we want to apply the gating function(e.g. <code>curv2filter</code> or <code><a href="https://rdrr.io/pkg/flowClust/man/tmixFilter.html">flowClust::tmixFilter</a></code>) that returns more than one gates, we can set <code>pop</code> to <code><a href="https://rdrr.io/r/base/Arithmetic.html">*</a></code> and specify multiple population names within <code>alias</code> with comma-separated characters.</p>
<table class="table">
<thead><tr class="header">
<th align="left">alias</th>
<th align="left">pop</th>
<th align="left">parent</th>
<th align="left">dims</th>
<th align="left">gating_method</th>
<th align="left">gating_args</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">CD4,CD8</td>
<td align="left">*</td>
<td align="left">cd3</td>
<td align="left">cd4,cd8</td>
<td align="left">curv2gate</td>
<td align="left"></td>
</tr></tbody>
</table>
<p>Here we assume <code>curv1gate</code> always returns <code>two</code> gates in the order of <code><a href="https://rdrr.io/r/base/c.html">c("cd4", "cd8")</a></code>, then the population names in <code>alias</code> column will be matched to these two gates and two <code>dummy_gate</code> rows are generated that simply serves as a reference to be used<br>
as <code>parent</code> node of the downstream gates.</p>
<table class="table">
<thead><tr class="header">
<th align="left">alias</th>
<th align="left">pop</th>
<th align="left">parent</th>
<th align="left">dims</th>
<th align="left">gating_method</th>
<th align="left">gating_args</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">CD4,CD8</td>
<td align="left">*</td>
<td align="left">cd3</td>
<td align="left">cd4,cd8</td>
<td align="left">curv2gate</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">CD4</td>
<td align="left"></td>
<td align="left">cd3</td>
<td align="left">cd4,cd8</td>
<td align="left">dummy_gate</td>
<td align="left">cd3/CD4,CD8</td>
</tr>
<tr class="odd">
<td align="left">CD8</td>
<td align="left"></td>
<td align="left">cd3</td>
<td align="left">cd4,cd8</td>
<td align="left">dummy_gate</td>
<td align="left">cd3/CD4,CD8</td>
</tr>
</tbody>
</table>
</div>
<div id="pop-and-alias" class="section level3">
<h3 class="hasAnchor">
<a href="#pop-and-alias" class="anchor"></a><code>pop</code> = “<em>" and <code>alias</code> = "</em>”</h3>
<p>If we don’t know how many gates will be returned by <code>curv2gate</code> or the order of gates are undetermined, thus we will not able to name these populations. As long as they are not used as <code>parent</code> nodes for the further gating (i.e. <code>terminal gate</code>s), we can simply set <code>alias</code> to <code><a href="https://rdrr.io/r/base/Arithmetic.html">*</a></code> .</p>
<table class="table">
<thead><tr class="header">
<th align="left">alias</th>
<th align="left">pop</th>
<th align="left">parent</th>
<th align="left">dims</th>
<th align="left">gating_method</th>
<th align="left">gating_args</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">*</td>
<td align="left">*</td>
<td align="left">cd3</td>
<td align="left">cd4,cd8</td>
<td align="left">curv2gate</td>
<td align="left"></td>
</tr></tbody>
</table>
<p>This will not be expanded in the <code>openCyto</code> framework. However, multiple populations will be generated and added to the <code>GatingSet</code> object. They are named by the <code>filterId</code> slot of <code>filter</code> objects.</p>
</div>
</div>
<div id="single-row-with-multiple-parents-i-e--parent-abc" class="section level2">
<h2 class="hasAnchor">
<a href="#single-row-with-multiple-parents-i-e--parent-abc" class="anchor"></a>Single row with multiple parents (i.e. <code>parent</code> =“A,B,C”)</h2>
<p>If the same gating method (or simply <code>refGate</code>) needs to be applied to multiple parents, it is possible to write these into the single row. For example,</p>
<table class="table">
<thead><tr class="header">
<th align="left">alias</th>
<th align="left">pop</th>
<th align="left">parent</th>
<th align="left">dims</th>
<th align="left">gating_method</th>
<th align="left">gating_args</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">IL2+</td>
<td align="left">+</td>
<td align="left">cd4,cd8</td>
<td align="left">IL2</td>
<td align="left">refGate</td>
<td align="left">cd3/IL2+</td>
</tr></tbody>
</table>
<p>This row is interpreted as copying the <code>IL2</code> gate that has been generated from <code>cd3</code> population and applying it to <code>cd4</code> and <code>cd8</code>, which is equivalent to the rows of below</p>
<table class="table">
<thead><tr class="header">
<th align="left">alias</th>
<th align="left">pop</th>
<th align="left">parent</th>
<th align="left">dims</th>
<th align="left">gating_method</th>
<th align="left">gating_args</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">IL2+</td>
<td align="left">+</td>
<td align="left">cd4</td>
<td align="left">IL2</td>
<td align="left">refGate</td>
<td align="left">cd3/IL2+</td>
</tr>
<tr class="even">
<td align="left">IL2+</td>
<td align="left">+</td>
<td align="left">cd8</td>
<td align="left">IL2</td>
<td align="left">refGate</td>
<td align="left">cd3/IL2+</td>
</tr>
</tbody>
</table>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#how-to-write-a-csv-gating-template">How to write a csv gating template</a><ul class="nav nav-pills nav-stacked">
<li><a href="#pop--"><code>pop</code> = “+/-”</a></li>
      <li><a href="#pop"><code>pop</code> = “++”</a></li>
      <li><a href="#pop---"><code>pop</code> = “+/-+/-”</a></li>
      <li><a href="#gating-method-that-generates-multiple-populations">Gating method that generates multiple populations</a></li>
      <li><a href="#single-row-with-multiple-parents-i-e--parent-abc">Single row with multiple parents (i.e. <code>parent</code> =“A,B,C”)</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Mike Jiang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
